# Content Improvement System Configuration Guide

## Table of Contents

- [Environment Variables](#environment-variables)
- [Brand Voice Configuration](#brand-voice-configuration)
- [API Keys Setup](#api-keys-setup)
- [System Settings](#system-settings)
- [Advanced Configuration](#advanced-configuration)
- [Development vs Production](#development-vs-production)
- [Troubleshooting Configuration](#troubleshooting-configuration)

## Environment Variables

### Required Environment Variables

The system requires specific environment variables to function properly. Create these files in your project:

#### Main Project (`.env.local`)
```bash
# AI Services
OPENAI_API_KEY=sk-your-openai-api-key-here

# Content System Settings
CONTENT_SYSTEM_ENABLED=true
CONTENT_AUTO_BACKUP=true
CONTENT_QUALITY_THRESHOLD=75
CONTENT_REVIEW_REQUIRED=true

# Optional: Advanced Settings
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=4000
CONTENT_LOG_LEVEL=info
CONTENT_MAX_IMPROVEMENTS_PER_RUN=50
CONTENT_ANALYTICS_ENABLED=true

# Optional: Integration
INTEGRATION_WEBHOOK_URL=https://your-domain.com/webhook
INTEGRATION_SECRET=your-webhook-secret

# Optional: Additional AI Services
FREEPIK_API_KEY=your-freepik-key
REPLICATE_API_TOKEN=your-replicate-token
```

#### Content-Improver System (`.env`)
This file is automatically generated from the main configuration, but you can create it manually:

```bash
# Core Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=4000

# System Settings
CONTENT_QUALITY_THRESHOLD=75
CONTENT_LOG_LEVEL=info
CONTENT_MAX_IMPROVEMENTS_PER_RUN=50
CONTENT_REVIEW_REQUIRED=true
CONTENT_ANALYTICS_ENABLED=true

# Development
NODE_ENV=development
```

### Environment Variable Reference

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `OPENAI_API_KEY` | ✅ | - | Your OpenAI API key for content improvements |
| `CONTENT_SYSTEM_ENABLED` | ❌ | `true` | Enable/disable the entire content system |
| `CONTENT_AUTO_BACKUP` | ❌ | `true` | Automatically backup files before changes |
| `CONTENT_QUALITY_THRESHOLD` | ❌ | `75` | Minimum quality score (0-100) |
| `CONTENT_REVIEW_REQUIRED` | ❌ | `true` | Require manual review before applying changes |
| `OPENAI_MODEL` | ❌ | `gpt-4-turbo-preview` | OpenAI model to use |
| `OPENAI_MAX_TOKENS` | ❌ | `4000` | Maximum tokens per API call |
| `CONTENT_LOG_LEVEL` | ❌ | `info` | Logging level (debug, info, warn, error) |
| `CONTENT_MAX_IMPROVEMENTS_PER_RUN` | ❌ | `50` | Maximum improvements per workflow run |
| `CONTENT_ANALYTICS_ENABLED` | ❌ | `true` | Enable analytics tracking |

### Setting Environment Variables

#### Development (Local)
```bash
# Create .env.local in project root
echo "OPENAI_API_KEY=your-key-here" >> .env.local
echo "CONTENT_SYSTEM_ENABLED=true" >> .env.local

# Or copy from example
cp .env.example .env.local
# Edit .env.local with your values
```

#### Production
Set environment variables through your deployment platform:

**Vercel:**
```bash
vercel env add OPENAI_API_KEY
vercel env add CONTENT_SYSTEM_ENABLED
```

**Netlify:**
```bash
netlify env:set OPENAI_API_KEY your-key-here
netlify env:set CONTENT_SYSTEM_ENABLED true
```

**Docker:**
```dockerfile
ENV OPENAI_API_KEY=your-key-here
ENV CONTENT_SYSTEM_ENABLED=true
```

## Brand Voice Configuration

### Brand Voice Profile

Create or customize `/content-improver/brand-voice-config.json`:

```json
{
  "brandName": "DesignWorks Bureau",
  "industry": "Design & Development",
  "targetAudience": "Small businesses and startups",
  
  "tone": {
    "professional": 8,
    "friendly": 9,
    "confident": 8,
    "approachable": 9,
    "innovative": 7
  },
  
  "vocabulary": {
    "technical": 6,
    "casual": 7,
    "industry": [
      "design",
      "branding",
      "user experience",
      "digital strategy",
      "conversion optimization"
    ],
    "avoid": [
      "synergy",
      "leverage",
      "paradigm shift",
      "game-changing",
      "revolutionary"
    ],
    "preferred": [
      "create",
      "build",
      "craft",
      "deliver",
      "transform"
    ]
  },
  
  "structure": {
    "sentenceLength": "medium",
    "paragraphLength": "short",
    "useEmojis": false,
    "useBulletPoints": true
  },
  
  "messaging": {
    "valueProposition": [
      "Premium design at startup speed",
      "Unlimited design requests",
      "Fixed monthly rate"
    ],
    "keyMessages": [
      "We help startups look professional from day one",
      "Design shouldn't be a barrier to growth",
      "Fast, reliable, and high-quality design work"
    ],
    "callsToAction": [
      "Start your project",
      "Get started today",
      "See our work",
      "Book a call"
    ]
  },
  
  "contentTypes": {
    "hero": {
      "maxLength": 200,
      "tone": "confident",
      "includeEmotionalHook": true,
      "includeBenefit": true
    },
    "service": {
      "maxLength": 300,
      "tone": "professional",
      "includeProcess": true,
      "includeOutcome": true
    },
    "testimonial": {
      "maxLength": 150,
      "tone": "authentic",
      "includeSpecifics": true,
      "includeResults": true
    }
  }
}
```

### Brand Voice Validation Rules

Create custom validation rules in `/content-improver/validation-rules.json`:

```json
{
  "rules": [
    {
      "name": "avoid_jargon",
      "type": "vocabulary",
      "severity": "high",
      "pattern": "\\b(leverage|synergy|paradigm)\\b",
      "message": "Avoid corporate jargon",
      "suggestion": "Use simpler, more direct language"
    },
    {
      "name": "active_voice",
      "type": "grammar",
      "severity": "medium",
      "pattern": "\\b(was|were)\\s+\\w+ed\\b",
      "message": "Consider using active voice",
      "suggestion": "Replace passive voice with active constructions"
    },
    {
      "name": "sentence_length",
      "type": "structure",
      "severity": "low",
      "maxWords": 25,
      "message": "Sentence may be too long",
      "suggestion": "Break into shorter sentences for better readability"
    },
    {
      "name": "call_to_action",
      "type": "conversion",
      "severity": "high",
      "requiredSections": ["hero", "services", "pricing"],
      "message": "Missing clear call-to-action",
      "suggestion": "Add a specific action for users to take"
    }
  ],
  
  "thresholds": {
    "readabilityScore": 60,
    "brandAlignmentScore": 80,
    "emotionalImpactScore": 70
  }
}
```

## API Keys Setup

### OpenAI API Key

1. **Get API Key**
   - Visit [OpenAI API Keys](https://platform.openai.com/api-keys)
   - Create new secret key
   - Copy the key (starts with `sk-`)

2. **Configure Key**
```bash
# Add to .env.local
OPENAI_API_KEY=sk-your-key-here

# Test configuration
cd content-improver
node -e "console.log(process.env.OPENAI_API_KEY ? '✅ Key configured' : '❌ Key missing')"
```

3. **Set Usage Limits**
   - Configure spending limits in OpenAI dashboard
   - Monitor usage to avoid unexpected charges
   - Typical usage: $5-15/month for active content improvement

### Optional API Keys

#### Freepik API (for image generation)
```bash
# Get key from https://www.freepik.com/api
FREEPIK_API_KEY=your-freepik-key

# Test
curl -H "x-freepik-api-key: your-key" "https://api.freepik.com/v1/icons?query=design"
```

#### Replicate API (for AI image generation)
```bash
# Get token from https://replicate.com/account/api-tokens
REPLICATE_API_TOKEN=r8_your-token

# Test
curl -H "Authorization: Token r8_your-token" https://api.replicate.com/v1/models
```

### API Key Security

#### Development
```bash
# Never commit API keys
echo ".env.local" >> .gitignore
echo "content-improver/.env" >> .gitignore

# Use different keys for development and production
OPENAI_API_KEY_DEV=sk-dev-key
OPENAI_API_KEY_PROD=sk-prod-key
```

#### Production
- Store keys in environment variables, not in code
- Rotate keys regularly
- Use least-privilege access
- Monitor API usage for unusual activity

## System Settings

### Content Quality Settings

Configure quality thresholds and improvement behavior:

```json
// content-improver/config/quality-settings.json
{
  "qualityThresholds": {
    "minimum": 60,
    "target": 80,
    "excellent": 90
  },
  
  "analysisWeights": {
    "grammar": 0.2,
    "clarity": 0.25,
    "brandVoice": 0.25,
    "seo": 0.15,
    "engagement": 0.15
  },
  
  "improvementSettings": {
    "maxSuggestionsPerSection": 10,
    "confidenceThreshold": 0.7,
    "preserveOriginalLength": false,
    "prioritizeHighImpact": true
  },
  
  "autoApprovalRules": {
    "enabled": false,
    "minConfidence": 0.9,
    "allowedTypes": ["grammar", "spelling"],
    "excludedSections": ["hero", "pricing"]
  }
}
```

### Workflow Configuration

Customize the workflow behavior:

```json
// content-improver/config/workflow-settings.json
{
  "stages": {
    "analysis": {
      "enabled": true,
      "timeout": 300000,
      "parallel": true,
      "maxConcurrency": 3
    },
    "improvement": {
      "enabled": true,
      "timeout": 600000,
      "rateLimitDelay": 2000,
      "retryAttempts": 3
    },
    "review": {
      "required": true,
      "timeout": 0,
      "autoOpenDashboard": true,
      "dashboardPort": 3001
    },
    "implementation": {
      "createBackup": true,
      "validateChanges": true,
      "rollbackOnError": true
    }
  },
  
  "notifications": {
    "email": {
      "enabled": false,
      "recipients": ["admin@example.com"],
      "events": ["workflow_complete", "errors"]
    },
    "webhook": {
      "enabled": false,
      "url": "https://your-webhook-url.com",
      "secret": "your-webhook-secret"
    }
  }
}
```

## Advanced Configuration

### AI Model Configuration

Fine-tune AI model behavior:

```json
// content-improver/config/ai-settings.json
{
  "openai": {
    "models": {
      "analysis": "gpt-3.5-turbo",
      "improvement": "gpt-4-turbo-preview",
      "review": "gpt-3.5-turbo"
    },
    "parameters": {
      "temperature": 0.3,
      "maxTokens": 4000,
      "topP": 0.9,
      "frequencyPenalty": 0.1,
      "presencePenalty": 0.1
    },
    "prompts": {
      "systemPrompt": "You are a professional content editor specializing in brand-consistent copywriting...",
      "analysisPrompt": "Analyze the following content for quality, brand voice, and improvement opportunities...",
      "improvementPrompt": "Improve the following content while maintaining the brand voice and key message..."
    }
  },
  
  "rateLimiting": {
    "requestsPerMinute": 20,
    "tokensPerMinute": 100000,
    "backoffStrategy": "exponential"
  }
}
```

### File System Configuration

Configure file handling and storage:

```json
// content-improver/config/filesystem-settings.json
{
  "paths": {
    "data": "../data",
    "improvements": "./improvements",
    "backups": "./backups",
    "reports": "./reports",
    "logs": "./logs"
  },
  
  "backup": {
    "maxBackups": 10,
    "compressionEnabled": true,
    "retentionDays": 30,
    "namingPattern": "YYYY-MM-DD_HH-mm-ss"
  },
  
  "processing": {
    "maxFileSize": "10MB",
    "allowedExtensions": [".json"],
    "excludePatterns": ["*.backup.*", "node_modules/**"],
    "encoding": "utf8"
  }
}
```

### Logging Configuration

Set up comprehensive logging:

```json
// content-improver/config/logging-settings.json
{
  "level": "info",
  "format": "json",
  
  "transports": {
    "console": {
      "enabled": true,
      "level": "info",
      "colorize": true
    },
    "file": {
      "enabled": true,
      "level": "debug",
      "filename": "logs/content-system.log",
      "maxSize": "10MB",
      "maxFiles": 5,
      "rotationPattern": "YYYY-MM-DD"
    }
  },
  
  "categories": {
    "workflow": "info",
    "api": "debug",
    "analysis": "info",
    "improvement": "info",
    "implementation": "info"
  }
}
```

## Development vs Production

### Development Configuration

```bash
# .env.local (development)
NODE_ENV=development
CONTENT_LOG_LEVEL=debug
CONTENT_ANALYTICS_ENABLED=true
DEBUG=content-improver:*

# More verbose logging
# Lower quality thresholds for testing
# Auto-backup enabled
# Review required for safety
```

### Production Configuration

```bash
# Production environment variables
NODE_ENV=production
CONTENT_LOG_LEVEL=info
CONTENT_ANALYTICS_ENABLED=false
CONTENT_AUTO_BACKUP=true
CONTENT_REVIEW_REQUIRED=true

# Optimized for performance
# Higher quality thresholds
# Error reporting enabled
# Security hardened
```

### Configuration Validation

Validate your configuration:

```bash
# Check configuration
cd content-improver
npm run config:validate

# Test configuration
npm run config:test

# View effective configuration
npm run config:show
```

## Troubleshooting Configuration

### Common Configuration Issues

#### Issue: "OpenAI API Key not found"
**Solutions:**
```bash
# Check if key exists
echo $OPENAI_API_KEY

# Verify .env.local location (project root, not content-improver)
ls -la .env.local

# Check key format
grep OPENAI_API_KEY .env.local
```

#### Issue: "Content system disabled"
**Solutions:**
```bash
# Enable content system
echo "CONTENT_SYSTEM_ENABLED=true" >> .env.local

# Restart application
npm run dev
```

#### Issue: "Permission denied writing to files"
**Solutions:**
```bash
# Fix directory permissions
chmod -R 755 content-improver/
chmod 755 data/

# Check disk space
df -h
```

#### Issue: "High API costs"
**Solutions:**
```bash
# Reduce model usage
OPENAI_MODEL=gpt-3.5-turbo  # Instead of gpt-4

# Limit improvements
CONTENT_MAX_IMPROVEMENTS_PER_RUN=20

# Set usage alerts in OpenAI dashboard
```

### Configuration Testing

Test your configuration:

```bash
# Test API connectivity
cd content-improver
node -e "
const openai = require('openai');
const client = new openai.OpenAI();
client.models.list().then(() => console.log('✅ OpenAI connected')).catch(console.error);
"

# Test file permissions
npm run test:permissions

# Validate configuration
npm run config:validate

# Test complete workflow
npm run test:workflow
```

### Configuration Backup

Backup your configuration:

```bash
# Create configuration backup
mkdir -p config-backup
cp .env.local config-backup/
cp content-improver/.env config-backup/
cp content-improver/brand-voice-config.json config-backup/

# Document configuration
cd content-improver
npm run config:export > config-backup/exported-config.json
```

### Environment-Specific Settings

#### Local Development
```bash
# .env.local
CONTENT_LOG_LEVEL=debug
CONTENT_QUALITY_THRESHOLD=60
CONTENT_REVIEW_REQUIRED=true
CONTENT_AUTO_BACKUP=true
```

#### Staging Environment
```bash
# .env.staging
CONTENT_LOG_LEVEL=info
CONTENT_QUALITY_THRESHOLD=75
CONTENT_REVIEW_REQUIRED=true
CONTENT_AUTO_BACKUP=true
CONTENT_ANALYTICS_ENABLED=false
```

#### Production Environment
```bash
# .env.production
CONTENT_LOG_LEVEL=warn
CONTENT_QUALITY_THRESHOLD=80
CONTENT_REVIEW_REQUIRED=true
CONTENT_AUTO_BACKUP=true
CONTENT_ANALYTICS_ENABLED=false
INTEGRATION_WEBHOOK_URL=https://api.example.com/webhook
```

## Security Configuration

### API Key Security
- Use environment variables, never hardcode keys
- Rotate keys regularly (monthly recommended)
- Use different keys for different environments
- Monitor API usage for anomalies
- Set spending limits and alerts

### File System Security
- Restrict file permissions appropriately
- Validate all file paths
- Sanitize user inputs
- Use safe JSON parsing
- Implement proper error handling

### Network Security
- Use HTTPS for all external API calls
- Validate webhook signatures
- Implement rate limiting
- Use secure headers
- Monitor for unusual traffic patterns

This configuration guide should help you set up and customize the Content Improvement System according to your needs. Always test configuration changes in a development environment before applying to production.